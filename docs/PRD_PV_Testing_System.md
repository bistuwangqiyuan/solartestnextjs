# 光伏测试系统产品需求文档 (PRD)

## 1. 项目概述

### 1.1 产品名称
光伏测试系统 (PV Testing System)

### 1.2 产品目标
构建一个基于Web的光伏组件测试系统，实现对太阳能电池板的自动化测试、数据采集、分析和监控功能。

### 1.3 技术栈
- 前端：Next.js 14 (App Router)、Tailwind CSS
- 后端：Supabase (数据库和认证)
- 部署：Netlify
- 通信协议：Modbus TCP/RTU
- 数据分析：实时数据处理和可视化

## 2. 功能需求

### 2.1 用户认证和权限管理
- 用户登录/登出功能
- 基于角色的权限控制（管理员、操作员、观察员）
- 用户信息管理
- 密码重置功能

### 2.2 仪表板 (Dashboard)
- 实时数据显示
  - 当前电压、电流、功率
  - 温度、湿度、光照强度
  - 系统状态指示器
- 关键性能指标（KPI）展示
- 异常告警提示
- 快速操作入口

### 2.3 数据管理 (Data Management)
- 测试数据列表展示
  - 支持分页、排序、筛选
  - 显示测试时间、参数、结果
- 数据导入/导出功能
  - 支持Excel、CSV格式
  - 批量数据处理
- 数据删除和归档
- 数据备份和恢复

### 2.4 实验管理 (Experiment)
- 创建新实验
  - 设置实验参数
  - 选择测试模式
- 实验模板管理
- 实验执行控制
  - 开始/暂停/停止
  - 实时进度显示
- 实验结果记录

### 2.5 实时监控 (Monitor)
- 设备连接状态
- 实时数据曲线
  - I-V曲线
  - P-V曲线
  - 时间序列数据
- 参数实时调整
- 告警配置和通知

### 2.6 数据分析 (Analysis)
- 历史数据分析
  - 趋势分析
  - 对比分析
  - 统计分析
- 报告生成
  - 测试报告
  - 分析报告
  - 自定义报告模板
- 数据可视化
  - 图表展示
  - 数据透视表

### 2.7 系统设置 (Settings)
- 设备配置
  - Modbus连接参数
  - 设备地址映射
- 系统参数设置
  - 采样频率
  - 数据保存策略
  - 告警阈值
- 用户管理
- 系统日志查看

## 3. 数据模型

### 3.1 用户表 (users)
- id: UUID
- email: 邮箱
- password: 密码（加密）
- role: 角色
- created_at: 创建时间
- last_login: 最后登录时间

### 3.2 实验表 (experiments)
- id: UUID
- name: 实验名称
- description: 描述
- parameters: JSON (实验参数)
- status: 状态（进行中/已完成/已取消）
- created_by: 创建人
- created_at: 创建时间
- started_at: 开始时间
- ended_at: 结束时间

### 3.3 测试数据表 (test_data)
- id: UUID
- experiment_id: 关联实验
- timestamp: 时间戳
- voltage: 电压 (V)
- current: 电流 (A)
- power: 功率 (W)
- temperature: 温度 (°C)
- irradiance: 光照强度 (W/m²)
- efficiency: 效率 (%)

### 3.4 设备表 (devices)
- id: UUID
- name: 设备名称
- type: 设备类型
- modbus_address: Modbus地址
- connection_params: JSON (连接参数)
- status: 状态（在线/离线）
- last_seen: 最后在线时间

### 3.5 告警表 (alerts)
- id: UUID
- device_id: 设备ID
- type: 告警类型
- message: 告警信息
- severity: 严重程度
- created_at: 创建时间
- resolved_at: 解决时间

## 4. 非功能需求

### 4.1 性能要求
- 页面加载时间 < 3秒
- 实时数据刷新率 ≥ 1Hz
- 支持同时连接10台设备
- 数据查询响应时间 < 2秒

### 4.2 安全要求
- 所有API调用需要认证
- 敏感数据加密存储
- 支持HTTPS
- 防止SQL注入和XSS攻击

### 4.3 可用性要求
- 系统可用性 > 99%
- 支持移动端响应式设计
- 友好的错误提示
- 操作日志记录

### 4.4 兼容性要求
- 支持Chrome、Firefox、Safari、Edge浏览器
- 支持iOS和Android移动设备
- Modbus TCP/RTU协议兼容

## 5. 界面设计原则

### 5.1 设计风格
- 工业风格UI设计
- 深色主题为主
- 清晰的数据展示
- 直观的操作流程

### 5.2 响应式设计
- 移动优先设计
- 自适应布局
- 触摸友好的交互

### 5.3 用户体验
- 统一的导航结构
- 实时反馈
- 加载状态提示
- 错误处理和恢复

## 6. 开发计划

### 阶段1：基础架构（第1-2周）
- 项目初始化和配置
- Supabase数据库设计
- 认证系统实现
- 基础页面布局

### 阶段2：核心功能（第3-4周）
- 仪表板开发
- 数据管理功能
- 实验管理功能
- Modbus通信实现

### 阶段3：高级功能（第5-6周）
- 实时监控功能
- 数据分析功能
- 报告生成功能
- 系统设置功能

### 阶段4：优化和测试（第7-8周）
- 性能优化
- 单元测试
- 集成测试
- 用户验收测试

### 阶段5：部署和文档（第9周）
- Netlify部署配置
- 用户文档编写
- 运维文档编写
- 培训材料准备

## 7. 成功指标

- 系统稳定运行，无重大故障
- 数据采集准确率 > 99.9%
- 用户满意度 > 85%
- 页面响应时间符合要求
- 功能覆盖率 100%