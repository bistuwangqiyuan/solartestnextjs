# 光伏测试系统软件使用说明书

## 一、软件概述

光伏测试系统是一套面向光伏组件性能测试与数据分析的专业化软件平台，采用现代化的Web技术架构构建。系统基于Next.js 14框架开发，集成Supabase云数据库服务，通过Modbus TCP/RTU通信协议实现对光伏设备的实时监控、数据采集、性能分析和测试管理。

系统主要面向光伏组件制造商、测试机构、科研院所等专业用户，提供完整的太阳能电池板测试解决方案。通过标准化的测试流程和精确的数据采集，系统能够准确测量光伏组件的关键电气参数，包括开路电压、短路电流、最大功率点、填充因子、转换效率等核心指标。

系统采用工业级UI设计理念，提供深色主题界面，确保在强光环境下具有良好的可视性。界面布局采用左侧导航栏与右侧内容区域的经典设计，操作流程直观简洁，符合工业软件的使用习惯。系统支持多用户并发访问，提供基于角色的权限管理机制，确保数据安全和操作规范。

## 二、功能模块说明

### （一）用户认证与权限管理模块

用户认证与权限管理模块是系统安全运行的基础保障，提供完整的用户身份验证和访问控制功能。系统采用基于邮箱和密码的传统认证方式，结合Supabase提供的安全认证服务，确保用户身份的真实性和数据传输的安全性。

系统支持三种用户角色：管理员、操作员和观察员。管理员拥有系统的完全访问权限，包括用户管理、系统配置、数据管理等所有功能；操作员可以进行实验操作、数据采集、报告生成等核心业务功能，但无法修改系统配置和用户信息；观察员仅具备数据查看权限，可以浏览测试结果和分析报告，但不能进行任何修改操作。

用户登录后，系统会自动记录登录时间和IP地址，并在用户信息区域显示当前用户的邮箱地址和角色类型。系统提供密码重置功能，用户可以通过邮箱接收重置链接来修改密码。所有用户操作都会在系统日志中记录，便于审计和问题追踪。

### （二）仪表板监控模块

仪表板监控模块是系统的核心展示界面，提供光伏测试系统的实时运行状态和关键性能指标。界面采用卡片式布局设计，将重要信息以直观的方式呈现给用户。

实时数据显示区域包含六个关键参数：电压、电流、功率、温度、光照强度和转换效率。每个参数以独立的卡片形式展示，包含当前数值、单位标识、趋势指示器和图标。数据每2秒自动刷新一次，确保信息的实时性和准确性。趋势指示器通过箭头方向显示参数变化趋势，帮助用户快速识别系统状态变化。

系统状态概览区域显示四个核心指标：在线设备数量、活跃实验数量、今日数据点总数和活跃告警数量。这些指标以统计卡片的形式展示，每个卡片包含图标、数值和描述信息，帮助用户快速了解系统整体运行状况。

告警信息区域显示最近发生的系统告警，包括告警类型、告警内容和发生时间。告警信息以列表形式展示，不同类型的告警使用不同的颜色标识，便于用户快速识别告警级别。快速操作区域提供四个常用功能的快捷入口：新建实验、导出数据、设备检查和查看告警，提高用户操作效率。

### （三）数据管理模块

数据管理模块提供完整的测试数据存储、查询、导出和管理功能。系统采用关系型数据库存储测试数据，支持大规模数据的快速检索和统计分析。

数据列表展示功能支持分页显示，默认每页显示20条记录，用户可以根据需要调整每页显示数量。列表包含实验名称、测试时间、电压、电流、功率、温度、光照强度、效率和数据点数量等关键信息。每条记录都有对应的复选框，支持批量选择操作。

搜索功能支持按实验名称进行模糊查询，用户输入关键词后系统会实时过滤显示匹配的记录。筛选功能提供多种筛选条件，包括时间范围、参数范围、设备类型等，帮助用户快速定位所需数据。

数据导出功能支持Excel和CSV两种格式，用户可以选择导出全部数据或仅导出选中的记录。导出的文件包含完整的数据信息和元数据，确保数据的完整性和可追溯性。系统还提供数据导入功能，支持从Excel或CSV文件批量导入历史测试数据。

### （四）实验管理模块

实验管理模块是系统的核心业务功能，提供完整的实验创建、执行、监控和管理流程。系统支持多种实验类型，包括标准测试、性能测试、耐久性测试等，满足不同测试需求。

实验创建功能提供直观的参数配置界面，用户需要填写实验名称、实验描述、测试类型等基本信息。系统提供实验模板功能，用户可以选择预设的测试模板或创建自定义模板，提高实验配置效率。

参数配置功能允许用户设置测试参数，包括电压范围、电流范围、采样频率、测试时长等。系统提供参数验证功能，确保配置的参数在设备支持范围内。设备选择功能显示所有可用的测试设备，用户可以选择单台或多台设备进行测试。

实验控制功能提供开始、暂停、停止三个基本控制按钮。开始按钮启动实验并开始数据采集；暂停按钮临时停止数据采集，实验状态保持，可以恢复继续；停止按钮结束实验并保存所有数据。系统实时显示实验进度和状态信息，包括已采集数据点数量、预计完成时间等。

### （五）实时监控模块

实时监控模块提供设备连接状态监控和实时数据曲线显示功能。系统通过Modbus协议与测试设备建立通信连接，实时获取设备运行状态和测试数据。

设备连接状态显示功能以状态指示器的形式展示每台设备的连接状态。绿色指示灯表示设备在线且通信正常；红色指示灯表示设备离线或通信异常；黄色指示灯表示连接不稳定或数据异常。每个设备状态卡片显示设备名称、连接时间、最后通信时间等信息。

实时数据曲线功能提供三种类型的图表：I-V特性曲线、P-V特性曲线和时间序列数据图。I-V特性曲线显示电流与电压的关系，横轴为电压值，纵轴为电流值；P-V特性曲线显示功率与电压的关系，横轴为电压值，纵轴为功率值；时间序列数据图显示各参数随时间的变化趋势，支持多参数同时显示。

参数调整控制功能允许用户在实验过程中实时调整测试参数，包括输出电压、电流限制、采样频率等。系统提供参数验证和范围检查，确保调整的参数在安全范围内。告警配置功能允许用户设置各种告警阈值，当参数超出设定范围时系统会自动触发告警。

### （六）数据分析模块

数据分析模块提供强大的历史数据分析和报告生成功能。系统支持多种分析方法和可视化展示，帮助用户深入理解测试数据和设备性能。

历史数据查询功能支持多种查询条件，包括时间范围、实验类型、设备选择、参数范围等。用户可以通过组合不同的查询条件来精确筛选所需数据。查询结果支持表格视图、图表视图、统计视图和对比视图四种展示方式。

趋势分析功能提供长期数据趋势分析，包括年度、月度、周度等不同时间尺度的趋势图。系统自动计算增长率、平均值、最大值、最小值等统计指标，帮助用户识别性能变化趋势和异常情况。

效率分析功能专门针对光伏转换效率进行分析，包括效率分布统计、效率变化趋势、效率影响因素分析等。系统提供效率排名功能，帮助用户识别高效和低效设备。

对比分析功能支持多个实验或设备的数据对比，用户可以并排比较不同条件下的测试结果，识别差异和影响因素。系统提供相关性分析功能，分析各参数之间的相关关系。

报告生成功能支持多种报告类型，包括测试报告、分析报告、统计报告和自定义报告。报告可以导出为PDF、Excel、Word或HTML格式，满足不同的使用需求。

### （七）系统设置模块

系统设置模块提供全面的系统配置和管理功能，包括设备配置、系统参数设置、用户管理和系统维护等。

设备配置功能允许用户配置Modbus连接参数，包括IP地址、端口号、设备ID、超时时间、重试次数等。系统提供设备地址映射配置，用户可以设置电压寄存器、电流寄存器、功率寄存器等Modbus寄存器地址。

系统参数设置功能包括数据采集设置、告警阈值设置、显示设置等。数据采集设置允许用户配置采样频率、数据保存间隔、缓存大小等参数；告警阈值设置允许用户设置各种告警的触发条件；显示设置允许用户配置界面主题、语言、时区等。

用户管理功能提供用户账户的创建、编辑、删除和权限管理。管理员可以创建新用户、修改用户信息、重置用户密码、分配用户角色等。系统提供用户操作日志功能，记录所有用户的操作行为。

系统维护功能包括数据备份、系统日志查看、性能监控等。系统提供自动备份功能，定期备份重要数据；日志查看功能允许用户查看系统运行日志和错误日志；性能监控功能显示系统资源使用情况和性能指标。

## 三、操作流程

光伏测试系统采用现代化的Web应用架构，用户通过浏览器访问系统界面，无需安装客户端软件。系统支持多用户并发访问，提供完整的测试流程管理和数据采集功能。

### 1. 系统访问与登录

用户首先需要在计算机上打开支持HTML5的现代浏览器，推荐使用Chrome 88+、Firefox 85+、Safari 14+或Edge 88+版本。在浏览器地址栏输入系统访问地址，系统会自动加载登录页面。

登录页面提供邮箱和密码输入框，用户需要输入有效的邮箱地址和对应密码。系统支持记住登录状态功能，用户可以选择在指定时间内保持登录状态，避免重复登录。点击登录按钮后，系统会验证用户身份信息，验证成功后自动跳转到系统主界面。

如果用户忘记密码，可以点击"忘记密码"链接，系统会发送密码重置邮件到用户注册邮箱。用户按照邮件中的指引完成密码重置操作。首次登录的用户建议修改默认密码，确保账户安全。

### 2. 系统界面导航

系统主界面采用经典的左右分栏布局，左侧为功能导航栏，右侧为内容显示区域。导航栏包含七个主要功能模块：仪表板、数据管理、实验管理、实时监控、数据分析、系统设置和帮助文档。

用户可以通过点击导航栏中的功能模块名称来切换不同的功能页面。当前激活的页面会以高亮颜色显示，帮助用户识别当前位置。导航栏底部显示用户信息区域，包括用户头像、邮箱地址、角色类型和退出登录按钮。

系统支持响应式设计，在不同屏幕尺寸下都能正常显示。在移动设备上，导航栏会自动折叠为汉堡菜单，用户可以通过点击菜单按钮来展开或收起导航选项。

### 3. 设备连接与配置

在进行测试实验之前，用户需要确保测试设备与系统正确连接。系统支持通过Modbus TCP/RTU协议与测试设备通信，用户需要在系统设置模块中配置设备连接参数。

在系统设置页面的设备配置区域，用户需要输入设备的IP地址、端口号、设备ID等连接参数。系统默认使用Modbus TCP协议，端口号为502。用户还需要配置设备地址映射，指定各种数据在Modbus寄存器中的存储地址。

配置完成后，用户可以点击"测试连接"按钮来验证设备连接是否正常。如果连接成功，系统会显示设备信息并更新连接状态。如果连接失败，系统会显示错误信息，用户需要检查网络连接和设备配置。

### 4. 实验创建与参数配置

用户可以通过实验管理模块创建新的测试实验。点击"新建实验"按钮后，系统会打开实验创建向导，引导用户完成实验配置。

首先需要填写实验基本信息，包括实验名称、实验描述、测试类型等。实验名称应该具有描述性，便于后续识别和管理。实验描述可以详细说明实验目的、测试条件、预期结果等信息。

接下来需要配置测试参数，包括电压范围、电流范围、采样频率、测试时长等。系统提供参数验证功能，确保配置的参数在设备支持范围内。用户可以参考设备技术规格或咨询技术支持人员来确定合适的参数值。

最后需要选择测试设备，系统会显示所有可用的设备列表，用户可以选择单台或多台设备进行测试。选择设备后，系统会显示设备的当前状态和基本信息，确认无误后可以保存实验配置。

### 5. 实验执行与数据采集

实验配置完成后，用户可以开始执行实验。在实验管理页面的实验列表中，找到目标实验并点击"开始实验"按钮。系统会向选定的设备发送测试命令，开始数据采集过程。

实验执行过程中，系统会实时显示实验状态和进度信息。用户可以在实时监控页面查看数据采集曲线，包括I-V特性曲线、P-V特性曲线和时间序列数据。系统每2秒更新一次数据，确保用户能够及时了解测试进展。

如果需要在实验过程中调整参数，用户可以点击"暂停实验"按钮，然后通过参数调整功能修改测试条件，修改完成后可以恢复实验继续执行。实验完成后，用户可以点击"停止实验"按钮来结束测试并保存所有数据。

### 6. 数据查看与分析

实验完成后，用户可以在数据管理页面查看测试结果。系统以表格形式显示所有测试数据，包括实验名称、测试时间、关键参数值等信息。用户可以使用搜索和筛选功能来快速定位所需数据。

在数据分析页面，用户可以查看详细的分析结果，包括趋势分析、效率分析、对比分析等。系统提供多种图表类型，帮助用户直观理解测试数据。用户可以根据需要调整时间范围、选择不同的分析维度。

系统支持数据导出功能，用户可以将测试数据导出为Excel或CSV格式文件，用于进一步分析或报告制作。导出的文件包含完整的数据信息和元数据，确保数据的完整性和可追溯性。

### 7. 报告生成与导出

系统提供强大的报告生成功能，用户可以根据测试数据生成各种类型的分析报告。在数据分析页面，用户可以选择报告类型、设置报告参数、选择数据范围等。

报告生成完成后，系统会显示报告预览，用户可以在线查看报告内容。如果满意，用户可以将报告导出为PDF、Excel、Word或HTML格式文件。导出的报告包含完整的分析结果、图表、统计数据和结论建议。

用户还可以创建自定义报告模板，将常用的分析方法和展示格式保存为模板，在后续的报告中重复使用，提高工作效率。

### 8. 系统维护与退出

完成所有测试工作后，用户应该正确退出系统。首先确保所有正在进行的实验已经完成或停止，然后点击用户信息区域的"退出登录"按钮。系统会自动保存用户的操作状态和未完成的工作。

系统管理员需要定期进行系统维护，包括数据备份、日志清理、性能监控等。系统提供自动备份功能，但建议管理员定期手动备份重要数据。系统日志会记录所有用户操作和系统事件，管理员应该定期查看日志文件，及时发现和解决问题。

## 四、技术指标

### 4.1 数据采集精度指标

系统采用高精度数据采集技术，确保测试数据的准确性和可靠性。电压测量精度达到0.01V，电流测量精度达到0.01A，功率计算精度达到0.01W。所有测量数据保留5位小数，满足光伏组件测试的精度要求。

数据采集采用16位模数转换器，采样频率可配置为1Hz到100Hz，默认采样频率为10Hz。系统支持实时数据验证和异常检测，当检测到数据异常时会自动标记并记录异常信息。

### 4.2 通信协议与接口

系统支持Modbus TCP和Modbus RTU两种通信协议，兼容主流的光伏测试设备。Modbus TCP协议支持网络连接，通信距离不受限制；Modbus RTU协议支持串口连接，适用于近距离设备通信。

通信参数支持多种配置：波特率支持9600、19200、38400、57600、115200 bps；数据位为8位；停止位为1位；校验方式支持无校验、奇校验、偶校验。系统提供自动设备发现功能，能够自动扫描网络中的Modbus设备。

### 4.3 系统性能指标

系统采用现代化的Web技术架构，具有优异的性能表现。页面加载时间小于3秒，实时数据刷新率达到1Hz以上，支持同时连接10台设备进行并发测试。

数据查询响应时间小于2秒，支持百万级数据记录的快速检索。系统采用分布式架构设计，支持水平扩展，能够满足大规模测试需求。

### 4.4 数据处理能力

系统支持大规模数据处理和分析，单次实验可采集多达10000个数据点，支持连续24小时不间断数据采集。数据存储采用关系型数据库，支持复杂查询和统计分析。

系统提供多种数据导出格式，包括Excel、CSV、JSON等，支持批量数据处理。数据压缩功能可以减少存储空间占用，提高数据传输效率。

### 4.5 安全与可靠性

系统采用多层安全防护机制，包括用户认证、数据加密、访问控制等。所有用户操作都需要身份验证，敏感数据采用AES-256加密存储。

系统可用性达到99%以上，采用冗余设计确保服务连续性。数据备份功能支持自动备份和手动备份，确保数据安全。系统提供完整的操作日志记录，支持审计和问题追踪。

## 五、运行环境要求

### 5.1 硬件环境要求

系统采用Web架构设计，对客户端硬件要求较低。推荐配置：处理器为双核2.0GHz以上，内存4GB以上，硬盘空间100GB以上，网络带宽10Mbps以上。

服务器端硬件要求：处理器为四核2.5GHz以上，内存8GB以上，硬盘空间500GB以上，网络带宽100Mbps以上。支持RAID磁盘阵列，确保数据安全。

### 5.2 软件环境要求

客户端操作系统支持Windows 10及以上版本、macOS 10.15及以上版本、Linux Ubuntu 18.04及以上版本。浏览器要求Chrome 88+、Firefox 85+、Safari 14+、Edge 88+等现代浏览器。

服务器端操作系统支持Windows Server 2019、Ubuntu Server 20.04 LTS、CentOS 8等主流服务器操作系统。数据库支持PostgreSQL 12+、MySQL 8.0+等关系型数据库。

### 5.3 网络环境要求

系统支持局域网和互联网部署，网络延迟要求小于100ms。支持HTTPS加密传输，确保数据传输安全。防火墙需要开放HTTP（80端口）和HTTPS（443端口）。

对于Modbus设备通信，需要确保网络连通性，支持TCP/IP协议。设备与服务器之间的网络延迟应小于50ms，确保实时数据采集的准确性。

### 5.4 设备兼容性

系统兼容主流的光伏测试设备，包括I-V特性测试仪、太阳模拟器、数据采集器等。设备需要支持Modbus TCP或Modbus RTU通信协议。

支持的设备品牌包括但不限于：Keysight、Tektronix、Fluke、Agilent等知名测试设备制造商。系统提供设备驱动库，支持新设备的快速接入。

## 六、注意事项

### 6.1 系统启动与连接

系统启动需要按照正确的顺序进行，首先启动数据库服务，然后启动应用服务器，最后启动Web服务。如果启动顺序不正确，可能导致系统无法正常工作。

设备连接前需要确保网络连通性，检查IP地址、端口号等连接参数是否正确。如果连接失败，需要检查防火墙设置、网络配置、设备状态等因素。

### 6.2 数据采集与存储

数据采集过程中需要确保设备稳定运行，避免突然断电或网络中断。系统提供数据缓存功能，但建议在稳定的网络环境下进行测试。

数据存储需要定期备份，建议每天进行增量备份，每周进行全量备份。备份数据应该存储在安全的位置，避免数据丢失。

### 6.3 用户权限与安全

用户应该使用强密码，定期更换密码，不要在公共场所登录系统。管理员应该定期审查用户权限，及时删除不再需要的用户账户。

系统提供操作日志功能，所有用户操作都会被记录。用户应该遵守系统使用规范，不得进行恶意操作或数据篡改。

### 6.4 性能优化与维护

系统长时间运行后可能出现性能下降，建议定期重启服务，清理临时文件和日志文件。定期检查磁盘空间，确保有足够的存储空间。

系统提供性能监控功能，管理员应该定期查看系统资源使用情况，及时发现和解决性能问题。

### 6.5 故障处理与技术支持

如果系统出现故障，用户应该首先检查网络连接、设备状态、浏览器设置等基本因素。如果问题仍然存在，应该联系技术支持人员。

系统提供详细的错误日志，用户可以将错误信息提供给技术支持人员，帮助快速定位和解决问题。

### 6.6 数据导出与备份

数据导出功能支持多种格式，用户应该根据实际需要选择合适的格式。导出的文件应该妥善保存，避免数据丢失。

系统提供自动备份功能，但用户也应该定期进行手动备份，确保重要数据的安全。备份数据应该进行验证，确保备份的完整性和可用性。

---

**文档版本**: 1.0  
**发布日期**: 2025年1月13日  
**适用软件版本**: v0.1.0  
**文档编制**: 光伏测试系统开发团队
